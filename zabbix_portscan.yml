zabbix_export:
  version: '6.0'
  date: '2024-02-17T14:01:33Z'
  groups:
    - uuid: 7df96b18c230490a9a0a9e2307226338
      name: Templates
  templates:
    - uuid: 2a18406f039647f3a1d93ff64edd5724
      template: 'Template Port Scanner - NMAP'
      name: 'Template Port Scanner - NMAP'
      groups:
        - name: Templates
      discovery_rules:
        - uuid: 54a9592319cd4ed38c460d06a6a2cfb1
          name: 'NMAP port scan results'
          type: TRAP
          key: nmap.discovery
          delay: '0'
          lifetime: 7d
          item_prototypes:
            - uuid: a2c0f466b9c641b3afa3978c50d6e8ea
              name: 'NMAP open port {#PORT} last seen'
              type: TRAP
              key: 'nmap.state[{#PORT}]'
              delay: '0'
              history: 7d
              units: unixtime
              description: 'Timestamp when the port was last seen open.'
              tags:
                - tag: component
                  value: nmap
                - tag: scope
                  value: security
              trigger_prototypes:
                - uuid: 28cece1d0b4348b6ac6114b534b58034
                  expression: 'last(/Template Port Scanner - NMAP/nmap.state[{#PORT}])>0 and nodata(/Template Port Scanner - NMAP/nmap.state[{#PORT}],{$NODATA_MAX})=0'
                  name: 'Port {#PORT} opened at last scan'
                  opdata: 'Checked: {ITEM.LASTVALUE}'
                  priority: WARNING
                  description: 'Trigger alert when timestamp of last check is greater than 0 and data was collected alt lest {$NODATA_MAX} ago.'
                  manual_close: 'YES'
                  tags:
                    - tag: component
                      value: nmap
                    - tag: scope
                      value: security
      macros:
        - macro: '{$NODATA_MAX}'
          value: 1d
